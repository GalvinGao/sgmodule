function extractPageData() {
  const url = new URL($request.url);
  // extract `imageId` from IMAGE_ID.html within the URL
  const imageId = url.pathname.match(/\/(\d+)\.html/)[1];

  // extract `expiresAt` from the `?t=` query string
  const expiresAt = url.searchParams.get("t");

  return { imageId, expiresAt };
}

function base64Decode(input) {
  // Define Base64 characters
  const chars =
    "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";

  // Remove any characters not in the Base64 characters list
  // and replace any '=' padding with ''
  let str = input.replace(/[^A-Za-z0-9+/]/g, "").replace(/=+$/, "");

  // Decoding
  let output = "";
  for (
    let bc = 0, bs = 0, buffer, i = 0;
    (buffer = str.charAt(i++));
    ~buffer && ((bs = bc % 4 ? bs * 64 + buffer : buffer), bc++ % 4)
      ? (output += String.fromCharCode(255 & (bs >> ((-2 * bc) & 6))))
      : 0
  ) {
    buffer = chars.indexOf(buffer);
  }

  // Handle UTF-8 decoding
  return decodeURIComponent(escape(output));
}

const b64ContentHTML =
  "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9InpoIj4KICA8aGVhZD4KICAgIDwhLS0gVmlld3BvcnQgbW9iaWxlIHRhZyBmb3Igc2Vuc2libGUgbW9iaWxlIHN1cHBvcnQgLS0+CiAgICA8bWV0YQogICAgICBuYW1lPSJ2aWV3cG9ydCIKICAgICAgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEsIG1heGltdW0tc2NhbGU9MSIKICAgIC8+CiAgICA8dGl0bGU+6Iie6JCMRFggLyDkuK3kuozoioLlpY8g55m75YWl5LqM57u056CBPC90aXRsZT48L2hlYWQKICA+PHN0eWxlPgogICAgaHRtbCwKICAgIGJvZHkgewogICAgICBtYXJnaW46IDA7CiAgICAgIHBhZGRpbmc6IDA7CiAgICAgIGhlaWdodDogMTAwJTsKICAgICAgd2lkdGg6IDEwMCU7CiAgICAgIGZvbnQtZmFtaWx5OiAtYXBwbGUtc3lzdGVtLCBCbGlua01hY1N5c3RlbUZvbnQsICJTZWdvZSBVSSIsIFJvYm90bywKICAgICAgICAiSGVsdmV0aWNhIE5ldWUiLCBBcmlhbCwgIk5vdG8gU2FucyIsIHNhbnMtc2VyaWYsICJBcHBsZSBDb2xvciBFbW9qaSIsCiAgICAgICAgIlNlZ29lIFVJIEVtb2ppIiwgIlNlZ29lIFVJIFN5bWJvbCIsICJOb3RvIENvbG9yIEVtb2ppIjsKICAgICAgZm9udC1zaXplOiAxNnB4OwogICAgICBiYWNrZ3JvdW5kOiB1cmwoImh0dHBzOi8vZHhyYXRpbmctYXNzZXRzLmltZ2cuZGV2L2ltYWdlcy9iYWNrZ3JvdW5kL2Zlc3RpdmFsLXBsdXMuanBnIikKICAgICAgICBuby1yZXBlYXQgY2VudGVyOwogICAgICBiYWNrZ3JvdW5kLXNpemU6IGNvdmVyOwogICAgfQogICAgLmNvbnRlbnRzIHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgICAgaGVpZ2h0OiAxMDAlOwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgIH0KICAgIC5oZWFkZXIgewogICAgICBkaXNwbGF5OiBub25lOwogICAgfQogICAgLmZvb3RlciB7CiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgYm90dG9tOiAwOwogICAgICBtYXJnaW4tYm90dG9tOiA2cmVtOwogICAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuNzUpOwogICAgICBwYWRkaW5nOiAwLjVyZW0gMXJlbTsKICAgICAgYm9yZGVyLXJhZGl1czogOTk5OXB4OwogICAgICBib3gtc2hhZG93OiAwIDRweCAxcmVtIHJnYmEoMCwgMCwgMCwgMC41KTsKICAgICAgY29sb3I6IHdoaXRlOwogICAgICBkaXNwbGF5OiBmbGV4OwogICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICBmb250LXZhcmlhbnQtbnVtZXJpYzogdGFidWxhci1udW1zOwogICAgfQogICAgLmZvb3Rlci13cmFwcGVyIHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICB9CiAgICAuZm9vdGVyLWxhYmVsIHsKICAgICAgbWFyZ2luLXJpZ2h0OiAwLjVyZW07CiAgICB9CiAgICAuZm9vdGVyLXZhbHVlIHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgICAgYWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7CiAgICB9CiAgICAuZm9vdGVyLWRhdGUgewogICAgICBmb250LXNpemU6IDEuMjVyZW07CiAgICAgIGxpbmUtaGVpZ2h0OiAxLjVyZW07CiAgICB9CiAgICAuZm9vdGVyLXJlbWFpbmluZy10aW1lIHsKICAgICAgZm9udC1zaXplOiAwLjc1cmVtOwogICAgICBsaW5lLWhlaWdodDogMXJlbTsKICAgICAgb3BhY2l0eTogMC43NTsKICAgICAgbGV0dGVyLXNwYWNpbmc6IDAuMDI1cmVtOwogICAgfQogICAgLndyYXBwZXIgewogICAgICBwYWRkaW5nOiAxcmVtOwogICAgICBiYWNrZ3JvdW5kOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuOCk7CiAgICAgIGJvcmRlcjogdGhpbiBzb2xpZCByZ2JhKDAsIDAsIDAsIDAuMjUpOwogICAgfQogICAgI3FyY29kZSB7CiAgICAgIHdpZHRoOiAxMHJlbTsKICAgICAgaGVpZ2h0OiAxMHJlbTsKICAgIH0KICAgICNxcmNvZGUgaW1nIHsKICAgICAgd2lkdGg6IDEwMCU7CiAgICAgIGhlaWdodDogMTAwJTsKICAgIH0KICAgIC5pY29uIHsKICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICB0b3A6IDA7CiAgICAgIG1hcmdpbi10b3A6IDZyZW07CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgfQogICAgLmljb24gPiBzdmcgewogICAgICB3aWR0aDogMnJlbTsKICAgICAgaGVpZ2h0OiAycmVtOwogICAgICBtYXJnaW4tYm90dG9tOiAwLjVyZW07CiAgICAgIG9wYWNpdHk6IDAuNTsKICAgIH0KICAgIC5pY29uID4gc3BhbiB7CiAgICAgIGZvbnQtc2l6ZTogMS4yNXJlbTsKICAgICAgbGV0dGVyLXNwYWNpbmc6IC0wLjA1cmVtOwogICAgfQogIDwvc3R5bGU+CiAgPGJvZHk+CiAgICA8ZGl2IGNsYXNzPSJjb250ZW50cyI+CiAgICAgIDxkaXYgY2xhc3M9Imljb24iPgogICAgICAgIDxzdmcKICAgICAgICAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgICAgICAgIHdpZHRoPSIyNCIKICAgICAgICAgIGhlaWdodD0iMjQiCiAgICAgICAgICB2aWV3Qm94PSIwIDAgMjQgMjQiCiAgICAgICAgPgogICAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiBmaWxsPSJub25lIiBzdHJva2U9Im5vbmUiIC8+CiAgICAgICAgICA8cGF0aAogICAgICAgICAgICBmaWxsPSJjdXJyZW50Q29sb3IiCiAgICAgICAgICAgIGQ9Ik00IDRoNnY2SDR6bTE2IDB2NmgtNlY0em0tNiAxMWgydi0yaC0ydi0yaDJ2Mmgydi0yaDJ2MmgtMnYyaDJ2M2gtMnYyaC0ydi0yaC0zdjJoLTJ2LTRoM3ptMiAwdjNoMnYtM3pNNCAyMHYtNmg2djZ6TTYgNnYyaDJWNnptMTAgMHYyaDJWNnpNNiAxNnYyaDJ2LTJ6bS0yLTVoMnYySDR6bTUgMGg0djRoLTJ2LTJIOXptMi01aDJ2NGgtMnpNMiAydjRIMFYyYTIgMiAwIDAgMSAyLTJoNHYyem0yMC0yYTIgMiAwIDAgMSAyIDJ2NGgtMlYyaC00VjB6TTIgMTh2NGg0djJIMmEyIDIgMCAwIDEtMi0ydi00em0yMCA0di00aDJ2NGEyIDIgMCAwIDEtMiAyaC00di0yeiIKICAgICAgICAgIC8+CiAgICAgICAgPC9zdmc+CiAgICAgIDwvZGl2PgogICAgICA8ZGl2IGNsYXNzPSJtYWluIj4KICAgICAgICA8ZGl2IGNsYXNzPSJ3cmFwcGVyIj48L2Rpdj4KICAgICAgPC9kaXY+CiAgICAgIDxkaXYgY2xhc3M9ImZvb3RlciI+PC9kaXY+CiAgICA8L2Rpdj4KICAgIF9fUEFHRV9EQVRBX1BMQUNFSE9MREVSX18KICAgIDwhLS0gcHJldHRpZXItaWdub3JlIC0tPgogICAgPHNjcmlwdD52YXIgUVJDb2RlOyFmdW5jdGlvbigpe2Z1bmN0aW9uIGEoYSl7dGhpcy5tb2RlPWMuTU9ERV84QklUX0JZVEUsdGhpcy5kYXRhPWEsdGhpcy5wYXJzZWREYXRhPVtdO2Zvcih2YXIgYj1bXSxkPTAsZT10aGlzLmRhdGEubGVuZ3RoO2U+ZDtkKyspe3ZhciBmPXRoaXMuZGF0YS5jaGFyQ29kZUF0KGQpO2Y+NjU1MzY/KGJbMF09MjQwfCgxODM1MDA4JmYpPj4+MTgsYlsxXT0xMjh8KDI1ODA0OCZmKT4+PjEyLGJbMl09MTI4fCg0MDMyJmYpPj4+NixiWzNdPTEyOHw2MyZmKTpmPjIwNDg/KGJbMF09MjI0fCg2MTQ0MCZmKT4+PjEyLGJbMV09MTI4fCg0MDMyJmYpPj4+NixiWzJdPTEyOHw2MyZmKTpmPjEyOD8oYlswXT0xOTJ8KDE5ODQmZik+Pj42LGJbMV09MTI4fDYzJmYpOmJbMF09Zix0aGlzLnBhcnNlZERhdGE9dGhpcy5wYXJzZWREYXRhLmNvbmNhdChiKX10aGlzLnBhcnNlZERhdGEubGVuZ3RoIT10aGlzLmRhdGEubGVuZ3RoJiYodGhpcy5wYXJzZWREYXRhLnVuc2hpZnQoMTkxKSx0aGlzLnBhcnNlZERhdGEudW5zaGlmdCgxODcpLHRoaXMucGFyc2VkRGF0YS51bnNoaWZ0KDIzOSkpfWZ1bmN0aW9uIGIoYSxiKXt0aGlzLnR5cGVOdW1iZXI9YSx0aGlzLmVycm9yQ29ycmVjdExldmVsPWIsdGhpcy5tb2R1bGVzPW51bGwsdGhpcy5tb2R1bGVDb3VudD0wLHRoaXMuZGF0YUNhY2hlPW51bGwsdGhpcy5kYXRhTGlzdD1bXX1mdW5jdGlvbiBpKGEsYil7aWYodm9pZCAwPT1hLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoYS5sZW5ndGgrIi8iK2IpO2Zvcih2YXIgYz0wO2M8YS5sZW5ndGgmJjA9PWFbY107KWMrKzt0aGlzLm51bT1uZXcgQXJyYXkoYS5sZW5ndGgtYytiKTtmb3IodmFyIGQ9MDtkPGEubGVuZ3RoLWM7ZCsrKXRoaXMubnVtW2RdPWFbZCtjXX1mdW5jdGlvbiBqKGEsYil7dGhpcy50b3RhbENvdW50PWEsdGhpcy5kYXRhQ291bnQ9Yn1mdW5jdGlvbiBrKCl7dGhpcy5idWZmZXI9W10sdGhpcy5sZW5ndGg9MH1mdW5jdGlvbiBtKCl7cmV0dXJuInVuZGVmaW5lZCIhPXR5cGVvZiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkR9ZnVuY3Rpb24gbigpe3ZhciBhPSExLGI9bmF2aWdhdG9yLnVzZXJBZ2VudDtyZXR1cm4vYW5kcm9pZC9pLnRlc3QoYikmJihhPSEwLGFNYXQ9Yi50b1N0cmluZygpLm1hdGNoKC9hbmRyb2lkIChbMC05XVwuWzAtOV0pL2kpLGFNYXQmJmFNYXRbMV0mJihhPXBhcnNlRmxvYXQoYU1hdFsxXSkpKSxhfWZ1bmN0aW9uIHIoYSxiKXtmb3IodmFyIGM9MSxlPXMoYSksZj0wLGc9bC5sZW5ndGg7Zz49ZjtmKyspe3ZhciBoPTA7c3dpdGNoKGIpe2Nhc2UgZC5MOmg9bFtmXVswXTticmVhaztjYXNlIGQuTTpoPWxbZl1bMV07YnJlYWs7Y2FzZSBkLlE6aD1sW2ZdWzJdO2JyZWFrO2Nhc2UgZC5IOmg9bFtmXVszXX1pZihoPj1lKWJyZWFrO2MrK31pZihjPmwubGVuZ3RoKXRocm93IG5ldyBFcnJvcigiVG9vIGxvbmcgZGF0YSIpO3JldHVybiBjfWZ1bmN0aW9uIHMoYSl7dmFyIGI9ZW5jb2RlVVJJKGEpLnRvU3RyaW5nKCkucmVwbGFjZSgvXCVbMC05YS1mQS1GXXsyfS9nLCJhIik7cmV0dXJuIGIubGVuZ3RoKyhiLmxlbmd0aCE9YT8zOjApfWEucHJvdG90eXBlPXtnZXRMZW5ndGg6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wYXJzZWREYXRhLmxlbmd0aH0sd3JpdGU6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPTAsYz10aGlzLnBhcnNlZERhdGEubGVuZ3RoO2M+YjtiKyspYS5wdXQodGhpcy5wYXJzZWREYXRhW2JdLDgpfX0sYi5wcm90b3R5cGU9e2FkZERhdGE6ZnVuY3Rpb24oYil7dmFyIGM9bmV3IGEoYik7dGhpcy5kYXRhTGlzdC5wdXNoKGMpLHRoaXMuZGF0YUNhY2hlPW51bGx9LGlzRGFyazpmdW5jdGlvbihhLGIpe2lmKDA+YXx8dGhpcy5tb2R1bGVDb3VudDw9YXx8MD5ifHx0aGlzLm1vZHVsZUNvdW50PD1iKXRocm93IG5ldyBFcnJvcihhKyIsIitiKTtyZXR1cm4gdGhpcy5tb2R1bGVzW2FdW2JdfSxnZXRNb2R1bGVDb3VudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1vZHVsZUNvdW50fSxtYWtlOmZ1bmN0aW9uKCl7dGhpcy5tYWtlSW1wbCghMSx0aGlzLmdldEJlc3RNYXNrUGF0dGVybigpKX0sbWFrZUltcGw6ZnVuY3Rpb24oYSxjKXt0aGlzLm1vZHVsZUNvdW50PTQqdGhpcy50eXBlTnVtYmVyKzE3LHRoaXMubW9kdWxlcz1uZXcgQXJyYXkodGhpcy5tb2R1bGVDb3VudCk7Zm9yKHZhciBkPTA7ZDx0aGlzLm1vZHVsZUNvdW50O2QrKyl7dGhpcy5tb2R1bGVzW2RdPW5ldyBBcnJheSh0aGlzLm1vZHVsZUNvdW50KTtmb3IodmFyIGU9MDtlPHRoaXMubW9kdWxlQ291bnQ7ZSsrKXRoaXMubW9kdWxlc1tkXVtlXT1udWxsfXRoaXMuc2V0dXBQb3NpdGlvblByb2JlUGF0dGVybigwLDApLHRoaXMuc2V0dXBQb3NpdGlvblByb2JlUGF0dGVybih0aGlzLm1vZHVsZUNvdW50LTcsMCksdGhpcy5zZXR1cFBvc2l0aW9uUHJvYmVQYXR0ZXJuKDAsdGhpcy5tb2R1bGVDb3VudC03KSx0aGlzLnNldHVwUG9zaXRpb25BZGp1c3RQYXR0ZXJuKCksdGhpcy5zZXR1cFRpbWluZ1BhdHRlcm4oKSx0aGlzLnNldHVwVHlwZUluZm8oYSxjKSx0aGlzLnR5cGVOdW1iZXI+PTcmJnRoaXMuc2V0dXBUeXBlTnVtYmVyKGEpLG51bGw9PXRoaXMuZGF0YUNhY2hlJiYodGhpcy5kYXRhQ2FjaGU9Yi5jcmVhdGVEYXRhKHRoaXMudHlwZU51bWJlcix0aGlzLmVycm9yQ29ycmVjdExldmVsLHRoaXMuZGF0YUxpc3QpKSx0aGlzLm1hcERhdGEodGhpcy5kYXRhQ2FjaGUsYyl9LHNldHVwUG9zaXRpb25Qcm9iZVBhdHRlcm46ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9LTE7Nz49YztjKyspaWYoISgtMT49YStjfHx0aGlzLm1vZHVsZUNvdW50PD1hK2MpKWZvcih2YXIgZD0tMTs3Pj1kO2QrKyktMT49YitkfHx0aGlzLm1vZHVsZUNvdW50PD1iK2R8fCh0aGlzLm1vZHVsZXNbYStjXVtiK2RdPWM+PTAmJjY+PWMmJigwPT1kfHw2PT1kKXx8ZD49MCYmNj49ZCYmKDA9PWN8fDY9PWMpfHxjPj0yJiY0Pj1jJiZkPj0yJiY0Pj1kPyEwOiExKX0sZ2V0QmVzdE1hc2tQYXR0ZXJuOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPTAsYj0wLGM9MDs4PmM7YysrKXt0aGlzLm1ha2VJbXBsKCEwLGMpO3ZhciBkPWYuZ2V0TG9zdFBvaW50KHRoaXMpOygwPT1jfHxhPmQpJiYoYT1kLGI9Yyl9cmV0dXJuIGJ9LGNyZWF0ZU1vdmllQ2xpcDpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9YS5jcmVhdGVFbXB0eU1vdmllQ2xpcChiLGMpLGU9MTt0aGlzLm1ha2UoKTtmb3IodmFyIGY9MDtmPHRoaXMubW9kdWxlcy5sZW5ndGg7ZisrKWZvcih2YXIgZz1mKmUsaD0wO2g8dGhpcy5tb2R1bGVzW2ZdLmxlbmd0aDtoKyspe3ZhciBpPWgqZSxqPXRoaXMubW9kdWxlc1tmXVtoXTtqJiYoZC5iZWdpbkZpbGwoMCwxMDApLGQubW92ZVRvKGksZyksZC5saW5lVG8oaStlLGcpLGQubGluZVRvKGkrZSxnK2UpLGQubGluZVRvKGksZytlKSxkLmVuZEZpbGwoKSl9cmV0dXJuIGR9LHNldHVwVGltaW5nUGF0dGVybjpmdW5jdGlvbigpe2Zvcih2YXIgYT04O2E8dGhpcy5tb2R1bGVDb3VudC04O2ErKyludWxsPT10aGlzLm1vZHVsZXNbYV1bNl0mJih0aGlzLm1vZHVsZXNbYV1bNl09MD09YSUyKTtmb3IodmFyIGI9ODtiPHRoaXMubW9kdWxlQ291bnQtODtiKyspbnVsbD09dGhpcy5tb2R1bGVzWzZdW2JdJiYodGhpcy5tb2R1bGVzWzZdW2JdPTA9PWIlMil9LHNldHVwUG9zaXRpb25BZGp1c3RQYXR0ZXJuOmZ1bmN0aW9uKCl7Zm9yKHZhciBhPWYuZ2V0UGF0dGVyblBvc2l0aW9uKHRoaXMudHlwZU51bWJlciksYj0wO2I8YS5sZW5ndGg7YisrKWZvcih2YXIgYz0wO2M8YS5sZW5ndGg7YysrKXt2YXIgZD1hW2JdLGU9YVtjXTtpZihudWxsPT10aGlzLm1vZHVsZXNbZF1bZV0pZm9yKHZhciBnPS0yOzI+PWc7ZysrKWZvcih2YXIgaD0tMjsyPj1oO2grKyl0aGlzLm1vZHVsZXNbZCtnXVtlK2hdPS0yPT1nfHwyPT1nfHwtMj09aHx8Mj09aHx8MD09ZyYmMD09aD8hMDohMX19LHNldHVwVHlwZU51bWJlcjpmdW5jdGlvbihhKXtmb3IodmFyIGI9Zi5nZXRCQ0hUeXBlTnVtYmVyKHRoaXMudHlwZU51bWJlciksYz0wOzE4PmM7YysrKXt2YXIgZD0hYSYmMT09KDEmYj4+Yyk7dGhpcy5tb2R1bGVzW01hdGguZmxvb3IoYy8zKV1bYyUzK3RoaXMubW9kdWxlQ291bnQtOC0zXT1kfWZvcih2YXIgYz0wOzE4PmM7YysrKXt2YXIgZD0hYSYmMT09KDEmYj4+Yyk7dGhpcy5tb2R1bGVzW2MlMyt0aGlzLm1vZHVsZUNvdW50LTgtM11bTWF0aC5mbG9vcihjLzMpXT1kfX0sc2V0dXBUeXBlSW5mbzpmdW5jdGlvbihhLGIpe2Zvcih2YXIgYz10aGlzLmVycm9yQ29ycmVjdExldmVsPDwzfGIsZD1mLmdldEJDSFR5cGVJbmZvKGMpLGU9MDsxNT5lO2UrKyl7dmFyIGc9IWEmJjE9PSgxJmQ+PmUpOzY+ZT90aGlzLm1vZHVsZXNbZV1bOF09Zzo4PmU/dGhpcy5tb2R1bGVzW2UrMV1bOF09Zzp0aGlzLm1vZHVsZXNbdGhpcy5tb2R1bGVDb3VudC0xNStlXVs4XT1nfWZvcih2YXIgZT0wOzE1PmU7ZSsrKXt2YXIgZz0hYSYmMT09KDEmZD4+ZSk7OD5lP3RoaXMubW9kdWxlc1s4XVt0aGlzLm1vZHVsZUNvdW50LWUtMV09Zzo5PmU/dGhpcy5tb2R1bGVzWzhdWzE1LWUtMSsxXT1nOnRoaXMubW9kdWxlc1s4XVsxNS1lLTFdPWd9dGhpcy5tb2R1bGVzW3RoaXMubW9kdWxlQ291bnQtOF1bOF09IWF9LG1hcERhdGE6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9LTEsZD10aGlzLm1vZHVsZUNvdW50LTEsZT03LGc9MCxoPXRoaXMubW9kdWxlQ291bnQtMTtoPjA7aC09Milmb3IoNj09aCYmaC0tOzspe2Zvcih2YXIgaT0wOzI+aTtpKyspaWYobnVsbD09dGhpcy5tb2R1bGVzW2RdW2gtaV0pe3ZhciBqPSExO2c8YS5sZW5ndGgmJihqPTE9PSgxJmFbZ10+Pj5lKSk7dmFyIGs9Zi5nZXRNYXNrKGIsZCxoLWkpO2smJihqPSFqKSx0aGlzLm1vZHVsZXNbZF1baC1pXT1qLGUtLSwtMT09ZSYmKGcrKyxlPTcpfWlmKGQrPWMsMD5kfHx0aGlzLm1vZHVsZUNvdW50PD1kKXtkLT1jLGM9LWM7YnJlYWt9fX19LGIuUEFEMD0yMzYsYi5QQUQxPTE3LGIuY3JlYXRlRGF0YT1mdW5jdGlvbihhLGMsZCl7Zm9yKHZhciBlPWouZ2V0UlNCbG9ja3MoYSxjKSxnPW5ldyBrLGg9MDtoPGQubGVuZ3RoO2grKyl7dmFyIGk9ZFtoXTtnLnB1dChpLm1vZGUsNCksZy5wdXQoaS5nZXRMZW5ndGgoKSxmLmdldExlbmd0aEluQml0cyhpLm1vZGUsYSkpLGkud3JpdGUoZyl9Zm9yKHZhciBsPTAsaD0wO2g8ZS5sZW5ndGg7aCsrKWwrPWVbaF0uZGF0YUNvdW50O2lmKGcuZ2V0TGVuZ3RoSW5CaXRzKCk+OCpsKXRocm93IG5ldyBFcnJvcigiY29kZSBsZW5ndGggb3ZlcmZsb3cuICgiK2cuZ2V0TGVuZ3RoSW5CaXRzKCkrIj4iKzgqbCsiKSIpO2ZvcihnLmdldExlbmd0aEluQml0cygpKzQ8PTgqbCYmZy5wdXQoMCw0KTswIT1nLmdldExlbmd0aEluQml0cygpJTg7KWcucHV0Qml0KCExKTtmb3IoOzspe2lmKGcuZ2V0TGVuZ3RoSW5CaXRzKCk+PTgqbClicmVhaztpZihnLnB1dChiLlBBRDAsOCksZy5nZXRMZW5ndGhJbkJpdHMoKT49OCpsKWJyZWFrO2cucHV0KGIuUEFEMSw4KX1yZXR1cm4gYi5jcmVhdGVCeXRlcyhnLGUpfSxiLmNyZWF0ZUJ5dGVzPWZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPTAsZD0wLGU9MCxnPW5ldyBBcnJheShiLmxlbmd0aCksaD1uZXcgQXJyYXkoYi5sZW5ndGgpLGo9MDtqPGIubGVuZ3RoO2orKyl7dmFyIGs9YltqXS5kYXRhQ291bnQsbD1iW2pdLnRvdGFsQ291bnQtaztkPU1hdGgubWF4KGQsayksZT1NYXRoLm1heChlLGwpLGdbal09bmV3IEFycmF5KGspO2Zvcih2YXIgbT0wO208Z1tqXS5sZW5ndGg7bSsrKWdbal1bbV09MjU1JmEuYnVmZmVyW20rY107Yys9azt2YXIgbj1mLmdldEVycm9yQ29ycmVjdFBvbHlub21pYWwobCksbz1uZXcgaShnW2pdLG4uZ2V0TGVuZ3RoKCktMSkscD1vLm1vZChuKTtoW2pdPW5ldyBBcnJheShuLmdldExlbmd0aCgpLTEpO2Zvcih2YXIgbT0wO208aFtqXS5sZW5ndGg7bSsrKXt2YXIgcT1tK3AuZ2V0TGVuZ3RoKCktaFtqXS5sZW5ndGg7aFtqXVttXT1xPj0wP3AuZ2V0KHEpOjB9fWZvcih2YXIgcj0wLG09MDttPGIubGVuZ3RoO20rKylyKz1iW21dLnRvdGFsQ291bnQ7Zm9yKHZhciBzPW5ldyBBcnJheShyKSx0PTAsbT0wO2Q+bTttKyspZm9yKHZhciBqPTA7ajxiLmxlbmd0aDtqKyspbTxnW2pdLmxlbmd0aCYmKHNbdCsrXT1nW2pdW21dKTtmb3IodmFyIG09MDtlPm07bSsrKWZvcih2YXIgaj0wO2o8Yi5sZW5ndGg7aisrKW08aFtqXS5sZW5ndGgmJihzW3QrK109aFtqXVttXSk7cmV0dXJuIHN9O2Zvcih2YXIgYz17TU9ERV9OVU1CRVI6MSxNT0RFX0FMUEhBX05VTToyLE1PREVfOEJJVF9CWVRFOjQsTU9ERV9LQU5KSTo4fSxkPXtMOjEsTTowLFE6MyxIOjJ9LGU9e1BBVFRFUk4wMDA6MCxQQVRURVJOMDAxOjEsUEFUVEVSTjAxMDoyLFBBVFRFUk4wMTE6MyxQQVRURVJOMTAwOjQsUEFUVEVSTjEwMTo1LFBBVFRFUk4xMTA6NixQQVRURVJOMTExOjd9LGY9e1BBVFRFUk5fUE9TSVRJT05fVEFCTEU6W1tdLFs2LDE4XSxbNiwyMl0sWzYsMjZdLFs2LDMwXSxbNiwzNF0sWzYsMjIsMzhdLFs2LDI0LDQyXSxbNiwyNiw0Nl0sWzYsMjgsNTBdLFs2LDMwLDU0XSxbNiwzMiw1OF0sWzYsMzQsNjJdLFs2LDI2LDQ2LDY2XSxbNiwyNiw0OCw3MF0sWzYsMjYsNTAsNzRdLFs2LDMwLDU0LDc4XSxbNiwzMCw1Niw4Ml0sWzYsMzAsNTgsODZdLFs2LDM0LDYyLDkwXSxbNiwyOCw1MCw3Miw5NF0sWzYsMjYsNTAsNzQsOThdLFs2LDMwLDU0LDc4LDEwMl0sWzYsMjgsNTQsODAsMTA2XSxbNiwzMiw1OCw4NCwxMTBdLFs2LDMwLDU4LDg2LDExNF0sWzYsMzQsNjIsOTAsMTE4XSxbNiwyNiw1MCw3NCw5OCwxMjJdLFs2LDMwLDU0LDc4LDEwMiwxMjZdLFs2LDI2LDUyLDc4LDEwNCwxMzBdLFs2LDMwLDU2LDgyLDEwOCwxMzRdLFs2LDM0LDYwLDg2LDExMiwxMzhdLFs2LDMwLDU4LDg2LDExNCwxNDJdLFs2LDM0LDYyLDkwLDExOCwxNDZdLFs2LDMwLDU0LDc4LDEwMiwxMjYsMTUwXSxbNiwyNCw1MCw3NiwxMDIsMTI4LDE1NF0sWzYsMjgsNTQsODAsMTA2LDEzMiwxNThdLFs2LDMyLDU4LDg0LDExMCwxMzYsMTYyXSxbNiwyNiw1NCw4MiwxMTAsMTM4LDE2Nl0sWzYsMzAsNTgsODYsMTE0LDE0MiwxNzBdXSxHMTU6MTMzNSxHMTg6Nzk3MyxHMTVfTUFTSzoyMTUyMixnZXRCQ0hUeXBlSW5mbzpmdW5jdGlvbihhKXtmb3IodmFyIGI9YTw8MTA7Zi5nZXRCQ0hEaWdpdChiKS1mLmdldEJDSERpZ2l0KGYuRzE1KT49MDspYl49Zi5HMTU8PGYuZ2V0QkNIRGlnaXQoYiktZi5nZXRCQ0hEaWdpdChmLkcxNSk7cmV0dXJuKGE8PDEwfGIpXmYuRzE1X01BU0t9LGdldEJDSFR5cGVOdW1iZXI6ZnVuY3Rpb24oYSl7Zm9yKHZhciBiPWE8PDEyO2YuZ2V0QkNIRGlnaXQoYiktZi5nZXRCQ0hEaWdpdChmLkcxOCk+PTA7KWJePWYuRzE4PDxmLmdldEJDSERpZ2l0KGIpLWYuZ2V0QkNIRGlnaXQoZi5HMTgpO3JldHVybiBhPDwxMnxifSxnZXRCQ0hEaWdpdDpmdW5jdGlvbihhKXtmb3IodmFyIGI9MDswIT1hOyliKyssYT4+Pj0xO3JldHVybiBifSxnZXRQYXR0ZXJuUG9zaXRpb246ZnVuY3Rpb24oYSl7cmV0dXJuIGYuUEFUVEVSTl9QT1NJVElPTl9UQUJMRVthLTFdfSxnZXRNYXNrOmZ1bmN0aW9uKGEsYixjKXtzd2l0Y2goYSl7Y2FzZSBlLlBBVFRFUk4wMDA6cmV0dXJuIDA9PShiK2MpJTI7Y2FzZSBlLlBBVFRFUk4wMDE6cmV0dXJuIDA9PWIlMjtjYXNlIGUuUEFUVEVSTjAxMDpyZXR1cm4gMD09YyUzO2Nhc2UgZS5QQVRURVJOMDExOnJldHVybiAwPT0oYitjKSUzO2Nhc2UgZS5QQVRURVJOMTAwOnJldHVybiAwPT0oTWF0aC5mbG9vcihiLzIpK01hdGguZmxvb3IoYy8zKSklMjtjYXNlIGUuUEFUVEVSTjEwMTpyZXR1cm4gMD09YipjJTIrYipjJTM7Y2FzZSBlLlBBVFRFUk4xMTA6cmV0dXJuIDA9PShiKmMlMitiKmMlMyklMjtjYXNlIGUuUEFUVEVSTjExMTpyZXR1cm4gMD09KGIqYyUzKyhiK2MpJTIpJTI7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoImJhZCBtYXNrUGF0dGVybjoiK2EpfX0sZ2V0RXJyb3JDb3JyZWN0UG9seW5vbWlhbDpmdW5jdGlvbihhKXtmb3IodmFyIGI9bmV3IGkoWzFdLDApLGM9MDthPmM7YysrKWI9Yi5tdWx0aXBseShuZXcgaShbMSxnLmdleHAoYyldLDApKTtyZXR1cm4gYn0sZ2V0TGVuZ3RoSW5CaXRzOmZ1bmN0aW9uKGEsYil7aWYoYj49MSYmMTA+Yilzd2l0Y2goYSl7Y2FzZSBjLk1PREVfTlVNQkVSOnJldHVybiAxMDtjYXNlIGMuTU9ERV9BTFBIQV9OVU06cmV0dXJuIDk7Y2FzZSBjLk1PREVfOEJJVF9CWVRFOnJldHVybiA4O2Nhc2UgYy5NT0RFX0tBTkpJOnJldHVybiA4O2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKCJtb2RlOiIrYSl9ZWxzZSBpZigyNz5iKXN3aXRjaChhKXtjYXNlIGMuTU9ERV9OVU1CRVI6cmV0dXJuIDEyO2Nhc2UgYy5NT0RFX0FMUEhBX05VTTpyZXR1cm4gMTE7Y2FzZSBjLk1PREVfOEJJVF9CWVRFOnJldHVybiAxNjtjYXNlIGMuTU9ERV9LQU5KSTpyZXR1cm4gMTA7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoIm1vZGU6IithKX1lbHNle2lmKCEoNDE+YikpdGhyb3cgbmV3IEVycm9yKCJ0eXBlOiIrYik7c3dpdGNoKGEpe2Nhc2UgYy5NT0RFX05VTUJFUjpyZXR1cm4gMTQ7Y2FzZSBjLk1PREVfQUxQSEFfTlVNOnJldHVybiAxMztjYXNlIGMuTU9ERV84QklUX0JZVEU6cmV0dXJuIDE2O2Nhc2UgYy5NT0RFX0tBTkpJOnJldHVybiAxMjtkZWZhdWx0OnRocm93IG5ldyBFcnJvcigibW9kZToiK2EpfX19LGdldExvc3RQb2ludDpmdW5jdGlvbihhKXtmb3IodmFyIGI9YS5nZXRNb2R1bGVDb3VudCgpLGM9MCxkPTA7Yj5kO2QrKylmb3IodmFyIGU9MDtiPmU7ZSsrKXtmb3IodmFyIGY9MCxnPWEuaXNEYXJrKGQsZSksaD0tMTsxPj1oO2grKylpZighKDA+ZCtofHxkK2g+PWIpKWZvcih2YXIgaT0tMTsxPj1pO2krKykwPmUraXx8ZStpPj1ifHwoMCE9aHx8MCE9aSkmJmc9PWEuaXNEYXJrKGQraCxlK2kpJiZmKys7Zj41JiYoYys9MytmLTUpfWZvcih2YXIgZD0wO2ItMT5kO2QrKylmb3IodmFyIGU9MDtiLTE+ZTtlKyspe3ZhciBqPTA7YS5pc0RhcmsoZCxlKSYmaisrLGEuaXNEYXJrKGQrMSxlKSYmaisrLGEuaXNEYXJrKGQsZSsxKSYmaisrLGEuaXNEYXJrKGQrMSxlKzEpJiZqKyssKDA9PWp8fDQ9PWopJiYoYys9Myl9Zm9yKHZhciBkPTA7Yj5kO2QrKylmb3IodmFyIGU9MDtiLTY+ZTtlKyspYS5pc0RhcmsoZCxlKSYmIWEuaXNEYXJrKGQsZSsxKSYmYS5pc0RhcmsoZCxlKzIpJiZhLmlzRGFyayhkLGUrMykmJmEuaXNEYXJrKGQsZSs0KSYmIWEuaXNEYXJrKGQsZSs1KSYmYS5pc0RhcmsoZCxlKzYpJiYoYys9NDApO2Zvcih2YXIgZT0wO2I+ZTtlKyspZm9yKHZhciBkPTA7Yi02PmQ7ZCsrKWEuaXNEYXJrKGQsZSkmJiFhLmlzRGFyayhkKzEsZSkmJmEuaXNEYXJrKGQrMixlKSYmYS5pc0RhcmsoZCszLGUpJiZhLmlzRGFyayhkKzQsZSkmJiFhLmlzRGFyayhkKzUsZSkmJmEuaXNEYXJrKGQrNixlKSYmKGMrPTQwKTtmb3IodmFyIGs9MCxlPTA7Yj5lO2UrKylmb3IodmFyIGQ9MDtiPmQ7ZCsrKWEuaXNEYXJrKGQsZSkmJmsrKzt2YXIgbD1NYXRoLmFicygxMDAqay9iL2ItNTApLzU7cmV0dXJuIGMrPTEwKmx9fSxnPXtnbG9nOmZ1bmN0aW9uKGEpe2lmKDE+YSl0aHJvdyBuZXcgRXJyb3IoImdsb2coIithKyIpIik7cmV0dXJuIGcuTE9HX1RBQkxFW2FdfSxnZXhwOmZ1bmN0aW9uKGEpe2Zvcig7MD5hOylhKz0yNTU7Zm9yKDthPj0yNTY7KWEtPTI1NTtyZXR1cm4gZy5FWFBfVEFCTEVbYV19LEVYUF9UQUJMRTpuZXcgQXJyYXkoMjU2KSxMT0dfVEFCTEU6bmV3IEFycmF5KDI1Nil9LGg9MDs4Pmg7aCsrKWcuRVhQX1RBQkxFW2hdPTE8PGg7Zm9yKHZhciBoPTg7MjU2Pmg7aCsrKWcuRVhQX1RBQkxFW2hdPWcuRVhQX1RBQkxFW2gtNF1eZy5FWFBfVEFCTEVbaC01XV5nLkVYUF9UQUJMRVtoLTZdXmcuRVhQX1RBQkxFW2gtOF07Zm9yKHZhciBoPTA7MjU1Pmg7aCsrKWcuTE9HX1RBQkxFW2cuRVhQX1RBQkxFW2hdXT1oO2kucHJvdG90eXBlPXtnZXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMubnVtW2FdfSxnZXRMZW5ndGg6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5udW0ubGVuZ3RofSxtdWx0aXBseTpmdW5jdGlvbihhKXtmb3IodmFyIGI9bmV3IEFycmF5KHRoaXMuZ2V0TGVuZ3RoKCkrYS5nZXRMZW5ndGgoKS0xKSxjPTA7Yzx0aGlzLmdldExlbmd0aCgpO2MrKylmb3IodmFyIGQ9MDtkPGEuZ2V0TGVuZ3RoKCk7ZCsrKWJbYytkXV49Zy5nZXhwKGcuZ2xvZyh0aGlzLmdldChjKSkrZy5nbG9nKGEuZ2V0KGQpKSk7cmV0dXJuIG5ldyBpKGIsMCl9LG1vZDpmdW5jdGlvbihhKXtpZih0aGlzLmdldExlbmd0aCgpLWEuZ2V0TGVuZ3RoKCk8MClyZXR1cm4gdGhpcztmb3IodmFyIGI9Zy5nbG9nKHRoaXMuZ2V0KDApKS1nLmdsb2coYS5nZXQoMCkpLGM9bmV3IEFycmF5KHRoaXMuZ2V0TGVuZ3RoKCkpLGQ9MDtkPHRoaXMuZ2V0TGVuZ3RoKCk7ZCsrKWNbZF09dGhpcy5nZXQoZCk7Zm9yKHZhciBkPTA7ZDxhLmdldExlbmd0aCgpO2QrKyljW2RdXj1nLmdleHAoZy5nbG9nKGEuZ2V0KGQpKStiKTtyZXR1cm4gbmV3IGkoYywwKS5tb2QoYSl9fSxqLlJTX0JMT0NLX1RBQkxFPVtbMSwyNiwxOV0sWzEsMjYsMTZdLFsxLDI2LDEzXSxbMSwyNiw5XSxbMSw0NCwzNF0sWzEsNDQsMjhdLFsxLDQ0LDIyXSxbMSw0NCwxNl0sWzEsNzAsNTVdLFsxLDcwLDQ0XSxbMiwzNSwxN10sWzIsMzUsMTNdLFsxLDEwMCw4MF0sWzIsNTAsMzJdLFsyLDUwLDI0XSxbNCwyNSw5XSxbMSwxMzQsMTA4XSxbMiw2Nyw0M10sWzIsMzMsMTUsMiwzNCwxNl0sWzIsMzMsMTEsMiwzNCwxMl0sWzIsODYsNjhdLFs0LDQzLDI3XSxbNCw0MywxOV0sWzQsNDMsMTVdLFsyLDk4LDc4XSxbNCw0OSwzMV0sWzIsMzIsMTQsNCwzMywxNV0sWzQsMzksMTMsMSw0MCwxNF0sWzIsMTIxLDk3XSxbMiw2MCwzOCwyLDYxLDM5XSxbNCw0MCwxOCwyLDQxLDE5XSxbNCw0MCwxNCwyLDQxLDE1XSxbMiwxNDYsMTE2XSxbMyw1OCwzNiwyLDU5LDM3XSxbNCwzNiwxNiw0LDM3LDE3XSxbNCwzNiwxMiw0LDM3LDEzXSxbMiw4Niw2OCwyLDg3LDY5XSxbNCw2OSw0MywxLDcwLDQ0XSxbNiw0MywxOSwyLDQ0LDIwXSxbNiw0MywxNSwyLDQ0LDE2XSxbNCwxMDEsODFdLFsxLDgwLDUwLDQsODEsNTFdLFs0LDUwLDIyLDQsNTEsMjNdLFszLDM2LDEyLDgsMzcsMTNdLFsyLDExNiw5MiwyLDExNyw5M10sWzYsNTgsMzYsMiw1OSwzN10sWzQsNDYsMjAsNiw0NywyMV0sWzcsNDIsMTQsNCw0MywxNV0sWzQsMTMzLDEwN10sWzgsNTksMzcsMSw2MCwzOF0sWzgsNDQsMjAsNCw0NSwyMV0sWzEyLDMzLDExLDQsMzQsMTJdLFszLDE0NSwxMTUsMSwxNDYsMTE2XSxbNCw2NCw0MCw1LDY1LDQxXSxbMTEsMzYsMTYsNSwzNywxN10sWzExLDM2LDEyLDUsMzcsMTNdLFs1LDEwOSw4NywxLDExMCw4OF0sWzUsNjUsNDEsNSw2Niw0Ml0sWzUsNTQsMjQsNyw1NSwyNV0sWzExLDM2LDEyXSxbNSwxMjIsOTgsMSwxMjMsOTldLFs3LDczLDQ1LDMsNzQsNDZdLFsxNSw0MywxOSwyLDQ0LDIwXSxbMyw0NSwxNSwxMyw0NiwxNl0sWzEsMTM1LDEwNyw1LDEzNiwxMDhdLFsxMCw3NCw0NiwxLDc1LDQ3XSxbMSw1MCwyMiwxNSw1MSwyM10sWzIsNDIsMTQsMTcsNDMsMTVdLFs1LDE1MCwxMjAsMSwxNTEsMTIxXSxbOSw2OSw0Myw0LDcwLDQ0XSxbMTcsNTAsMjIsMSw1MSwyM10sWzIsNDIsMTQsMTksNDMsMTVdLFszLDE0MSwxMTMsNCwxNDIsMTE0XSxbMyw3MCw0NCwxMSw3MSw0NV0sWzE3LDQ3LDIxLDQsNDgsMjJdLFs5LDM5LDEzLDE2LDQwLDE0XSxbMywxMzUsMTA3LDUsMTM2LDEwOF0sWzMsNjcsNDEsMTMsNjgsNDJdLFsxNSw1NCwyNCw1LDU1LDI1XSxbMTUsNDMsMTUsMTAsNDQsMTZdLFs0LDE0NCwxMTYsNCwxNDUsMTE3XSxbMTcsNjgsNDJdLFsxNyw1MCwyMiw2LDUxLDIzXSxbMTksNDYsMTYsNiw0NywxN10sWzIsMTM5LDExMSw3LDE0MCwxMTJdLFsxNyw3NCw0Nl0sWzcsNTQsMjQsMTYsNTUsMjVdLFszNCwzNywxM10sWzQsMTUxLDEyMSw1LDE1MiwxMjJdLFs0LDc1LDQ3LDE0LDc2LDQ4XSxbMTEsNTQsMjQsMTQsNTUsMjVdLFsxNiw0NSwxNSwxNCw0NiwxNl0sWzYsMTQ3LDExNyw0LDE0OCwxMThdLFs2LDczLDQ1LDE0LDc0LDQ2XSxbMTEsNTQsMjQsMTYsNTUsMjVdLFszMCw0NiwxNiwyLDQ3LDE3XSxbOCwxMzIsMTA2LDQsMTMzLDEwN10sWzgsNzUsNDcsMTMsNzYsNDhdLFs3LDU0LDI0LDIyLDU1LDI1XSxbMjIsNDUsMTUsMTMsNDYsMTZdLFsxMCwxNDIsMTE0LDIsMTQzLDExNV0sWzE5LDc0LDQ2LDQsNzUsNDddLFsyOCw1MCwyMiw2LDUxLDIzXSxbMzMsNDYsMTYsNCw0NywxN10sWzgsMTUyLDEyMiw0LDE1MywxMjNdLFsyMiw3Myw0NSwzLDc0LDQ2XSxbOCw1MywyMywyNiw1NCwyNF0sWzEyLDQ1LDE1LDI4LDQ2LDE2XSxbMywxNDcsMTE3LDEwLDE0OCwxMThdLFszLDczLDQ1LDIzLDc0LDQ2XSxbNCw1NCwyNCwzMSw1NSwyNV0sWzExLDQ1LDE1LDMxLDQ2LDE2XSxbNywxNDYsMTE2LDcsMTQ3LDExN10sWzIxLDczLDQ1LDcsNzQsNDZdLFsxLDUzLDIzLDM3LDU0LDI0XSxbMTksNDUsMTUsMjYsNDYsMTZdLFs1LDE0NSwxMTUsMTAsMTQ2LDExNl0sWzE5LDc1LDQ3LDEwLDc2LDQ4XSxbMTUsNTQsMjQsMjUsNTUsMjVdLFsyMyw0NSwxNSwyNSw0NiwxNl0sWzEzLDE0NSwxMTUsMywxNDYsMTE2XSxbMiw3NCw0NiwyOSw3NSw0N10sWzQyLDU0LDI0LDEsNTUsMjVdLFsyMyw0NSwxNSwyOCw0NiwxNl0sWzE3LDE0NSwxMTVdLFsxMCw3NCw0NiwyMyw3NSw0N10sWzEwLDU0LDI0LDM1LDU1LDI1XSxbMTksNDUsMTUsMzUsNDYsMTZdLFsxNywxNDUsMTE1LDEsMTQ2LDExNl0sWzE0LDc0LDQ2LDIxLDc1LDQ3XSxbMjksNTQsMjQsMTksNTUsMjVdLFsxMSw0NSwxNSw0Niw0NiwxNl0sWzEzLDE0NSwxMTUsNiwxNDYsMTE2XSxbMTQsNzQsNDYsMjMsNzUsNDddLFs0NCw1NCwyNCw3LDU1LDI1XSxbNTksNDYsMTYsMSw0NywxN10sWzEyLDE1MSwxMjEsNywxNTIsMTIyXSxbMTIsNzUsNDcsMjYsNzYsNDhdLFszOSw1NCwyNCwxNCw1NSwyNV0sWzIyLDQ1LDE1LDQxLDQ2LDE2XSxbNiwxNTEsMTIxLDE0LDE1MiwxMjJdLFs2LDc1LDQ3LDM0LDc2LDQ4XSxbNDYsNTQsMjQsMTAsNTUsMjVdLFsyLDQ1LDE1LDY0LDQ2LDE2XSxbMTcsMTUyLDEyMiw0LDE1MywxMjNdLFsyOSw3NCw0NiwxNCw3NSw0N10sWzQ5LDU0LDI0LDEwLDU1LDI1XSxbMjQsNDUsMTUsNDYsNDYsMTZdLFs0LDE1MiwxMjIsMTgsMTUzLDEyM10sWzEzLDc0LDQ2LDMyLDc1LDQ3XSxbNDgsNTQsMjQsMTQsNTUsMjVdLFs0Miw0NSwxNSwzMiw0NiwxNl0sWzIwLDE0NywxMTcsNCwxNDgsMTE4XSxbNDAsNzUsNDcsNyw3Niw0OF0sWzQzLDU0LDI0LDIyLDU1LDI1XSxbMTAsNDUsMTUsNjcsNDYsMTZdLFsxOSwxNDgsMTE4LDYsMTQ5LDExOV0sWzE4LDc1LDQ3LDMxLDc2LDQ4XSxbMzQsNTQsMjQsMzQsNTUsMjVdLFsyMCw0NSwxNSw2MSw0NiwxNl1dLGouZ2V0UlNCbG9ja3M9ZnVuY3Rpb24oYSxiKXt2YXIgYz1qLmdldFJzQmxvY2tUYWJsZShhLGIpO2lmKHZvaWQgMD09Yyl0aHJvdyBuZXcgRXJyb3IoImJhZCBycyBibG9jayBAIHR5cGVOdW1iZXI6IithKyIvZXJyb3JDb3JyZWN0TGV2ZWw6IitiKTtmb3IodmFyIGQ9Yy5sZW5ndGgvMyxlPVtdLGY9MDtkPmY7ZisrKWZvcih2YXIgZz1jWzMqZiswXSxoPWNbMypmKzFdLGk9Y1szKmYrMl0saz0wO2c+aztrKyspZS5wdXNoKG5ldyBqKGgsaSkpO3JldHVybiBlfSxqLmdldFJzQmxvY2tUYWJsZT1mdW5jdGlvbihhLGIpe3N3aXRjaChiKXtjYXNlIGQuTDpyZXR1cm4gai5SU19CTE9DS19UQUJMRVs0KihhLTEpKzBdO2Nhc2UgZC5NOnJldHVybiBqLlJTX0JMT0NLX1RBQkxFWzQqKGEtMSkrMV07Y2FzZSBkLlE6cmV0dXJuIGouUlNfQkxPQ0tfVEFCTEVbNCooYS0xKSsyXTtjYXNlIGQuSDpyZXR1cm4gai5SU19CTE9DS19UQUJMRVs0KihhLTEpKzNdO2RlZmF1bHQ6cmV0dXJuIHZvaWQgMH19LGsucHJvdG90eXBlPXtnZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9TWF0aC5mbG9vcihhLzgpO3JldHVybiAxPT0oMSZ0aGlzLmJ1ZmZlcltiXT4+PjctYSU4KX0scHV0OmZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPTA7Yj5jO2MrKyl0aGlzLnB1dEJpdCgxPT0oMSZhPj4+Yi1jLTEpKX0sZ2V0TGVuZ3RoSW5CaXRzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGVuZ3RofSxwdXRCaXQ6ZnVuY3Rpb24oYSl7dmFyIGI9TWF0aC5mbG9vcih0aGlzLmxlbmd0aC84KTt0aGlzLmJ1ZmZlci5sZW5ndGg8PWImJnRoaXMuYnVmZmVyLnB1c2goMCksYSYmKHRoaXMuYnVmZmVyW2JdfD0xMjg+Pj50aGlzLmxlbmd0aCU4KSx0aGlzLmxlbmd0aCsrfX07dmFyIGw9W1sxNywxNCwxMSw3XSxbMzIsMjYsMjAsMTRdLFs1Myw0MiwzMiwyNF0sWzc4LDYyLDQ2LDM0XSxbMTA2LDg0LDYwLDQ0XSxbMTM0LDEwNiw3NCw1OF0sWzE1NCwxMjIsODYsNjRdLFsxOTIsMTUyLDEwOCw4NF0sWzIzMCwxODAsMTMwLDk4XSxbMjcxLDIxMywxNTEsMTE5XSxbMzIxLDI1MSwxNzcsMTM3XSxbMzY3LDI4NywyMDMsMTU1XSxbNDI1LDMzMSwyNDEsMTc3XSxbNDU4LDM2MiwyNTgsMTk0XSxbNTIwLDQxMiwyOTIsMjIwXSxbNTg2LDQ1MCwzMjIsMjUwXSxbNjQ0LDUwNCwzNjQsMjgwXSxbNzE4LDU2MCwzOTQsMzEwXSxbNzkyLDYyNCw0NDIsMzM4XSxbODU4LDY2Niw0ODIsMzgyXSxbOTI5LDcxMSw1MDksNDAzXSxbMTAwMyw3NzksNTY1LDQzOV0sWzEwOTEsODU3LDYxMSw0NjFdLFsxMTcxLDkxMSw2NjEsNTExXSxbMTI3Myw5OTcsNzE1LDUzNV0sWzEzNjcsMTA1OSw3NTEsNTkzXSxbMTQ2NSwxMTI1LDgwNSw2MjVdLFsxNTI4LDExOTAsODY4LDY1OF0sWzE2MjgsMTI2NCw5MDgsNjk4XSxbMTczMiwxMzcwLDk4Miw3NDJdLFsxODQwLDE0NTIsMTAzMCw3OTBdLFsxOTUyLDE1MzgsMTExMiw4NDJdLFsyMDY4LDE2MjgsMTE2OCw4OThdLFsyMTg4LDE3MjIsMTIyOCw5NThdLFsyMzAzLDE4MDksMTI4Myw5ODNdLFsyNDMxLDE5MTEsMTM1MSwxMDUxXSxbMjU2MywxOTg5LDE0MjMsMTA5M10sWzI2OTksMjA5OSwxNDk5LDExMzldLFsyODA5LDIyMTMsMTU3OSwxMjE5XSxbMjk1MywyMzMxLDE2NjMsMTI3M11dLG89ZnVuY3Rpb24oKXt2YXIgYT1mdW5jdGlvbihhLGIpe3RoaXMuX2VsPWEsdGhpcy5faHRPcHRpb249Yn07cmV0dXJuIGEucHJvdG90eXBlLmRyYXc9ZnVuY3Rpb24oYSl7ZnVuY3Rpb24gZyhhLGIpe3ZhciBjPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLGEpO2Zvcih2YXIgZCBpbiBiKWIuaGFzT3duUHJvcGVydHkoZCkmJmMuc2V0QXR0cmlidXRlKGQsYltkXSk7cmV0dXJuIGN9dmFyIGI9dGhpcy5faHRPcHRpb24sYz10aGlzLl9lbCxkPWEuZ2V0TW9kdWxlQ291bnQoKTtNYXRoLmZsb29yKGIud2lkdGgvZCksTWF0aC5mbG9vcihiLmhlaWdodC9kKSx0aGlzLmNsZWFyKCk7dmFyIGg9Zygic3ZnIix7dmlld0JveDoiMCAwICIrU3RyaW5nKGQpKyIgIitTdHJpbmcoZCksd2lkdGg6IjEwMCUiLGhlaWdodDoiMTAwJSIsZmlsbDpiLmNvbG9yTGlnaHR9KTtoLnNldEF0dHJpYnV0ZU5TKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3htbG5zLyIsInhtbG5zOnhsaW5rIiwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIpLGMuYXBwZW5kQ2hpbGQoaCksaC5hcHBlbmRDaGlsZChnKCJyZWN0Iix7ZmlsbDpiLmNvbG9yRGFyayx3aWR0aDoiMSIsaGVpZ2h0OiIxIixpZDoidGVtcGxhdGUifSkpO2Zvcih2YXIgaT0wO2Q+aTtpKyspZm9yKHZhciBqPTA7ZD5qO2orKylpZihhLmlzRGFyayhpLGopKXt2YXIgaz1nKCJ1c2UiLHt4OlN0cmluZyhpKSx5OlN0cmluZyhqKX0pO2suc2V0QXR0cmlidXRlTlMoImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiLCJocmVmIiwiI3RlbXBsYXRlIiksaC5hcHBlbmRDaGlsZChrKX19LGEucHJvdG90eXBlLmNsZWFyPWZ1bmN0aW9uKCl7Zm9yKDt0aGlzLl9lbC5oYXNDaGlsZE5vZGVzKCk7KXRoaXMuX2VsLnJlbW92ZUNoaWxkKHRoaXMuX2VsLmxhc3RDaGlsZCl9LGF9KCkscD0ic3ZnIj09PWRvY3VtZW50LmRvY3VtZW50RWxlbWVudC50YWdOYW1lLnRvTG93ZXJDYXNlKCkscT1wP286bSgpP2Z1bmN0aW9uKCl7ZnVuY3Rpb24gYSgpe3RoaXMuX2VsSW1hZ2Uuc3JjPXRoaXMuX2VsQ2FudmFzLnRvRGF0YVVSTCgiaW1hZ2UvcG5nIiksdGhpcy5fZWxJbWFnZS5zdHlsZS5kaXNwbGF5PSJibG9jayIsdGhpcy5fZWxDYW52YXMuc3R5bGUuZGlzcGxheT0ibm9uZSJ9ZnVuY3Rpb24gZChhLGIpe3ZhciBjPXRoaXM7aWYoYy5fZkZhaWw9YixjLl9mU3VjY2Vzcz1hLG51bGw9PT1jLl9iU3VwcG9ydERhdGFVUkkpe3ZhciBkPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImltZyIpLGU9ZnVuY3Rpb24oKXtjLl9iU3VwcG9ydERhdGFVUkk9ITEsYy5fZkZhaWwmJl9mRmFpbC5jYWxsKGMpfSxmPWZ1bmN0aW9uKCl7Yy5fYlN1cHBvcnREYXRhVVJJPSEwLGMuX2ZTdWNjZXNzJiZjLl9mU3VjY2Vzcy5jYWxsKGMpfTtyZXR1cm4gZC5vbmFib3J0PWUsZC5vbmVycm9yPWUsZC5vbmxvYWQ9ZixkLnNyYz0iZGF0YTppbWFnZS9naWY7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFBVUFBQUFGQ0FZQUFBQ05ieWJsQUFBQUhFbEVRVlFJMTJQNC8vOC93MzhHSUFYRElCS0UwREh4Z2xqTkJBQU85VFhMMFk0T0h3QUFBQUJKUlU1RXJrSmdnZz09Iix2b2lkIDB9Yy5fYlN1cHBvcnREYXRhVVJJPT09ITAmJmMuX2ZTdWNjZXNzP2MuX2ZTdWNjZXNzLmNhbGwoYyk6Yy5fYlN1cHBvcnREYXRhVVJJPT09ITEmJmMuX2ZGYWlsJiZjLl9mRmFpbC5jYWxsKGMpfWlmKHRoaXMuX2FuZHJvaWQmJnRoaXMuX2FuZHJvaWQ8PTIuMSl7dmFyIGI9MS93aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyxjPUNhbnZhc1JlbmRlcmluZ0NvbnRleHQyRC5wcm90b3R5cGUuZHJhd0ltYWdlO0NhbnZhc1JlbmRlcmluZ0NvbnRleHQyRC5wcm90b3R5cGUuZHJhd0ltYWdlPWZ1bmN0aW9uKGEsZCxlLGYsZyxoLGksail7aWYoIm5vZGVOYW1lImluIGEmJi9pbWcvaS50ZXN0KGEubm9kZU5hbWUpKWZvcih2YXIgbD1hcmd1bWVudHMubGVuZ3RoLTE7bD49MTtsLS0pYXJndW1lbnRzW2xdPWFyZ3VtZW50c1tsXSpiO2Vsc2UidW5kZWZpbmVkIj09dHlwZW9mIGomJihhcmd1bWVudHNbMV0qPWIsYXJndW1lbnRzWzJdKj1iLGFyZ3VtZW50c1szXSo9Yixhcmd1bWVudHNbNF0qPWIpO2MuYXBwbHkodGhpcyxhcmd1bWVudHMpfX12YXIgZT1mdW5jdGlvbihhLGIpe3RoaXMuX2JJc1BhaW50ZWQ9ITEsdGhpcy5fYW5kcm9pZD1uKCksdGhpcy5faHRPcHRpb249Yix0aGlzLl9lbENhbnZhcz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJjYW52YXMiKSx0aGlzLl9lbENhbnZhcy53aWR0aD1iLndpZHRoLHRoaXMuX2VsQ2FudmFzLmhlaWdodD1iLmhlaWdodCxhLmFwcGVuZENoaWxkKHRoaXMuX2VsQ2FudmFzKSx0aGlzLl9lbD1hLHRoaXMuX29Db250ZXh0PXRoaXMuX2VsQ2FudmFzLmdldENvbnRleHQoIjJkIiksdGhpcy5fYklzUGFpbnRlZD0hMSx0aGlzLl9lbEltYWdlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImltZyIpLHRoaXMuX2VsSW1hZ2Uuc3R5bGUuZGlzcGxheT0ibm9uZSIsdGhpcy5fZWwuYXBwZW5kQ2hpbGQodGhpcy5fZWxJbWFnZSksdGhpcy5fYlN1cHBvcnREYXRhVVJJPW51bGx9O3JldHVybiBlLnByb3RvdHlwZS5kcmF3PWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuX2VsSW1hZ2UsYz10aGlzLl9vQ29udGV4dCxkPXRoaXMuX2h0T3B0aW9uLGU9YS5nZXRNb2R1bGVDb3VudCgpLGY9ZC53aWR0aC9lLGc9ZC5oZWlnaHQvZSxoPU1hdGgucm91bmQoZiksaT1NYXRoLnJvdW5kKGcpO2Iuc3R5bGUuZGlzcGxheT0ibm9uZSIsdGhpcy5jbGVhcigpO2Zvcih2YXIgaj0wO2U+ajtqKyspZm9yKHZhciBrPTA7ZT5rO2srKyl7dmFyIGw9YS5pc0RhcmsoaixrKSxtPWsqZixuPWoqZztjLnN0cm9rZVN0eWxlPWw/ZC5jb2xvckRhcms6ZC5jb2xvckxpZ2h0LGMubGluZVdpZHRoPTEsYy5maWxsU3R5bGU9bD9kLmNvbG9yRGFyazpkLmNvbG9yTGlnaHQsYy5maWxsUmVjdChtLG4sZixnKSxjLnN0cm9rZVJlY3QoTWF0aC5mbG9vcihtKSsuNSxNYXRoLmZsb29yKG4pKy41LGgsaSksYy5zdHJva2VSZWN0KE1hdGguY2VpbChtKS0uNSxNYXRoLmNlaWwobiktLjUsaCxpKX10aGlzLl9iSXNQYWludGVkPSEwfSxlLnByb3RvdHlwZS5tYWtlSW1hZ2U9ZnVuY3Rpb24oKXt0aGlzLl9iSXNQYWludGVkJiZkLmNhbGwodGhpcyxhKX0sZS5wcm90b3R5cGUuaXNQYWludGVkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2JJc1BhaW50ZWR9LGUucHJvdG90eXBlLmNsZWFyPWZ1bmN0aW9uKCl7dGhpcy5fb0NvbnRleHQuY2xlYXJSZWN0KDAsMCx0aGlzLl9lbENhbnZhcy53aWR0aCx0aGlzLl9lbENhbnZhcy5oZWlnaHQpLHRoaXMuX2JJc1BhaW50ZWQ9ITF9LGUucHJvdG90eXBlLnJvdW5kPWZ1bmN0aW9uKGEpe3JldHVybiBhP01hdGguZmxvb3IoMWUzKmEpLzFlMzphfSxlfSgpOmZ1bmN0aW9uKCl7dmFyIGE9ZnVuY3Rpb24oYSxiKXt0aGlzLl9lbD1hLHRoaXMuX2h0T3B0aW9uPWJ9O3JldHVybiBhLnByb3RvdHlwZS5kcmF3PWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj10aGlzLl9odE9wdGlvbixjPXRoaXMuX2VsLGQ9YS5nZXRNb2R1bGVDb3VudCgpLGU9TWF0aC5mbG9vcihiLndpZHRoL2QpLGY9TWF0aC5mbG9vcihiLmhlaWdodC9kKSxnPVsnPHRhYmxlIHN0eWxlPSJib3JkZXI6MDtib3JkZXItY29sbGFwc2U6Y29sbGFwc2U7Ij4nXSxoPTA7ZD5oO2grKyl7Zy5wdXNoKCI8dHI+Iik7Zm9yKHZhciBpPTA7ZD5pO2krKylnLnB1c2goJzx0ZCBzdHlsZT0iYm9yZGVyOjA7Ym9yZGVyLWNvbGxhcHNlOmNvbGxhcHNlO3BhZGRpbmc6MDttYXJnaW46MDt3aWR0aDonK2UrInB4O2hlaWdodDoiK2YrInB4O2JhY2tncm91bmQtY29sb3I6IisoYS5pc0RhcmsoaCxpKT9iLmNvbG9yRGFyazpiLmNvbG9yTGlnaHQpKyc7Ij48L3RkPicpO2cucHVzaCgiPC90cj4iKX1nLnB1c2goIjwvdGFibGU+IiksYy5pbm5lckhUTUw9Zy5qb2luKCIiKTt2YXIgaj1jLmNoaWxkTm9kZXNbMF0saz0oYi53aWR0aC1qLm9mZnNldFdpZHRoKS8yLGw9KGIuaGVpZ2h0LWoub2Zmc2V0SGVpZ2h0KS8yO2s+MCYmbD4wJiYoai5zdHlsZS5tYXJnaW49bCsicHggIitrKyJweCIpfSxhLnByb3RvdHlwZS5jbGVhcj1mdW5jdGlvbigpe3RoaXMuX2VsLmlubmVySFRNTD0iIn0sYX0oKTtRUkNvZGU9ZnVuY3Rpb24oYSxiKXtpZih0aGlzLl9odE9wdGlvbj17d2lkdGg6MjU2LGhlaWdodDoyNTYsdHlwZU51bWJlcjo0LGNvbG9yRGFyazoiIzAwMDAwMCIsY29sb3JMaWdodDoiI2ZmZmZmZiIsY29ycmVjdExldmVsOmQuSH0sInN0cmluZyI9PXR5cGVvZiBiJiYoYj17dGV4dDpifSksYilmb3IodmFyIGMgaW4gYil0aGlzLl9odE9wdGlvbltjXT1iW2NdOyJzdHJpbmciPT10eXBlb2YgYSYmKGE9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYSkpLHRoaXMuX2FuZHJvaWQ9bigpLHRoaXMuX2VsPWEsdGhpcy5fb1FSQ29kZT1udWxsLHRoaXMuX29EcmF3aW5nPW5ldyBxKHRoaXMuX2VsLHRoaXMuX2h0T3B0aW9uKSx0aGlzLl9odE9wdGlvbi50ZXh0JiZ0aGlzLm1ha2VDb2RlKHRoaXMuX2h0T3B0aW9uLnRleHQpfSxRUkNvZGUucHJvdG90eXBlLm1ha2VDb2RlPWZ1bmN0aW9uKGEpe3RoaXMuX29RUkNvZGU9bmV3IGIocihhLHRoaXMuX2h0T3B0aW9uLmNvcnJlY3RMZXZlbCksdGhpcy5faHRPcHRpb24uY29ycmVjdExldmVsKSx0aGlzLl9vUVJDb2RlLmFkZERhdGEoYSksdGhpcy5fb1FSQ29kZS5tYWtlKCksdGhpcy5fZWwudGl0bGU9YSx0aGlzLl9vRHJhd2luZy5kcmF3KHRoaXMuX29RUkNvZGUpLHRoaXMubWFrZUltYWdlKCl9LFFSQ29kZS5wcm90b3R5cGUubWFrZUltYWdlPWZ1bmN0aW9uKCl7ImZ1bmN0aW9uIj09dHlwZW9mIHRoaXMuX29EcmF3aW5nLm1ha2VJbWFnZSYmKCF0aGlzLl9hbmRyb2lkfHx0aGlzLl9hbmRyb2lkPj0zKSYmdGhpcy5fb0RyYXdpbmcubWFrZUltYWdlKCl9LFFSQ29kZS5wcm90b3R5cGUuY2xlYXI9ZnVuY3Rpb24oKXt0aGlzLl9vRHJhd2luZy5jbGVhcigpfSxRUkNvZGUuQ29ycmVjdExldmVsPWR9KCk7PC9zY3JpcHQ+CiAgICA8c2NyaXB0PgogICAgICBjb25zdCBwYWdlRGF0YSA9IEpTT04ucGFyc2UoCiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI3BhZ2VkYXRhIikudGV4dENvbnRlbnQKICAgICAgKTsKICAgICAgLy8gcGFyc2VEYXRlIHBhcnNlcyBhIGRhdGV0aW1lIGxpa2UgMTIvMTggMTM6NTYgdG8gYSBEYXRlIG9iamVjdC4KICAgICAgLy8gdGhlIGRhdGUgaXMgYXNzdW1lZCB0byBiZSBpbiB0aGUgY3VycmVudCB5ZWFyLiB0aGUgZGF0ZSBpcyBpbiB0aGUgR01UKzggdGltZXpvbmUuCiAgICAgIC8vIHlvdXIgcGFyc2VkIGRhdGUgc2hvdWxkIGFsc28gY29uc2lkZXIgdGhpcyB0aW1lem9uZSBpbmZvcm1hdGlvbiBhbmQgY29udmVydCBpdCB0byB5b3VyIGxvY2FsIHRpbWV6b25lLgogICAgICAvLyBmdW5jdGlvbiBwYXJzZURhdGUoZGF0ZXRpbWUpIHsKICAgICAgLy8gICAvLyBFeHRyYWN0IG1vbnRoLCBkYXksIGhvdXIsIGFuZCBtaW51dGUgZnJvbSB0aGUgaW5wdXQgc3RyaW5nCiAgICAgIC8vICAgY29uc3QgW2RhdGVQYXJ0LCB0aW1lUGFydF0gPSBkYXRldGltZS5zcGxpdCgiICIpOwogICAgICAvLyAgIGNvbnN0IFttb250aCwgZGF5XSA9IGRhdGVQYXJ0LnNwbGl0KCIvIikubWFwKE51bWJlcik7CiAgICAgIC8vICAgY29uc3QgW2hvdXIsIG1pbnV0ZV0gPSB0aW1lUGFydC5zcGxpdCgiOiIpLm1hcChOdW1iZXIpOwoKICAgICAgLy8gICAvLyBHZXQgdGhlIGN1cnJlbnQgeWVhcgogICAgICAvLyAgIGNvbnN0IGN1cnJlbnRZZWFyID0gbmV3IERhdGUoKS5nZXRGdWxsWWVhcigpOwoKICAgICAgLy8gICAvLyBDb25zdHJ1Y3QgYSBkYXRlIHN0cmluZyBpbiBhIGZvcm1hdCBzdWl0YWJsZSBmb3IgRGF0ZS5wYXJzZSgpCiAgICAgIC8vICAgY29uc3QgZGF0ZVN0cmluZyA9IGAke2N1cnJlbnRZZWFyfS0ke21vbnRoCiAgICAgIC8vICAgICAudG9TdHJpbmcoKQogICAgICAvLyAgICAgLnBhZFN0YXJ0KDIsICIwIil9LSR7ZGF5LnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgIjAiKX1UJHtob3VyCiAgICAgIC8vICAgICAudG9TdHJpbmcoKQogICAgICAvLyAgICAgLnBhZFN0YXJ0KDIsICIwIil9OiR7bWludXRlLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgIjAiKX06MDArMDg6MDBgOwoKICAgICAgLy8gICAvLyBQYXJzZSB0aGUgZGF0ZSBzdHJpbmcgYW5kIGNvbnZlcnQgaXQgdG8gdGhlIGxvY2FsIHRpbWV6b25lCiAgICAgIC8vICAgcmV0dXJuIG5ldyBEYXRlKGRhdGVTdHJpbmcpOwogICAgICAvLyB9CgogICAgICBjb25zdCBmb290ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuZm9vdGVyIik7CiAgICAgIGNvbnN0IGZvb3RlckRhdGUgPSBuZXcgRGF0ZShwYWdlRGF0YS5leHBpcmVzQXQpOwogICAgICBjb25zdCBmb290ZXJEYXRlRm9ybWF0dGVkID0gZm9vdGVyRGF0ZS50b0xvY2FsZVN0cmluZygiemgtQ04iLCB7CiAgICAgICAgdGltZVpvbmU6ICJBc2lhL1NoYW5naGFpIiwKICAgICAgICBtb250aDogIm51bWVyaWMiLAogICAgICAgIGRheTogIm51bWVyaWMiLAogICAgICAgIGhvdXI6ICJudW1lcmljIiwKICAgICAgICBtaW51dGU6ICJudW1lcmljIiwKICAgICAgfSk7CiAgICAgIGZvb3Rlci5pbm5lckhUTUwgPSBgPGRpdiBjbGFzcz0iZm9vdGVyLXdyYXBwZXIiPjxkaXYgY2xhc3M9ImZvb3Rlci1sYWJlbCI+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIGZpbGw9Im5vbmUiIHN0cm9rZT0ibm9uZSIgLz48cGF0aCBmaWxsPSJjdXJyZW50Q29sb3IiIGQ9Ik02IDJoMTJ2NmwtNCA0bDQgNHY2SDZ2LTZsNC00bC00LTR6bTEwIDE0LjVsLTQtNGwtNCA0VjIwaDh6bS00LTVsNC00VjRIOHYzLjV6TTEwIDZoNHYuNzVsLTIgMmwtMi0yeiIvPjwvc3ZnPjwvZGl2PjxkaXYgY2xhc3M9ImZvb3Rlci12YWx1ZSI+PGRpdiBjbGFzcz0iZm9vdGVyLWRhdGUiPiR7Zm9vdGVyRGF0ZUZvcm1hdHRlZH08L2Rpdj48ZGl2IGNsYXNzPSJmb290ZXItcmVtYWluaW5nLXRpbWUiPjwvZGl2PjwvZGl2PjwvZGl2PmA7CgogICAgICBmdW5jdGlvbiB1cGRhdGVSZW1haW5pbmdUaW1lKCkgewogICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7CiAgICAgICAgY29uc3QgcmVtYWluaW5nVGltZSA9IGZvb3RlckRhdGUgLSBub3c7CiAgICAgICAgY29uc3QgcmVtYWluaW5nU2Vjb25kcyA9IE1hdGguZmxvb3IocmVtYWluaW5nVGltZSAvIDEwMDApOwogICAgICAgIGNvbnN0IHJlbWFpbmluZ01pbnV0ZXMgPSBNYXRoLmZsb29yKHJlbWFpbmluZ1NlY29uZHMgLyA2MCk7CgogICAgICAgIGNvbnN0IHJlbWFpbmluZ01pbnV0ZXNJbkhvdXIgPSByZW1haW5pbmdNaW51dGVzICUgNjA7CiAgICAgICAgY29uc3QgcmVtYWluaW5nU2Vjb25kc0luTWludXRlID0gcmVtYWluaW5nU2Vjb25kcyAlIDYwOwoKICAgICAgICBjb25zdCByZW1haW5pbmdUaW1lU3RyaW5nID0KICAgICAgICAgIHJlbWFpbmluZ1RpbWUgPiAwCiAgICAgICAgICAgID8gYOWJqeS9mSAke3JlbWFpbmluZ01pbnV0ZXNJbkhvdXJ9bSR7cmVtYWluaW5nU2Vjb25kc0luTWludXRlfXNgCiAgICAgICAgICAgIDogYOW3suS6jiAke01hdGguYWJzKHJlbWFpbmluZ01pbnV0ZXNJbkhvdXIpfW0ke01hdGguYWJzKAogICAgICAgICAgICAgICAgcmVtYWluaW5nU2Vjb25kc0luTWludXRlCiAgICAgICAgICAgICAgKX1zIOWJjei/h+acn2A7CgogICAgICAgIGZvb3Rlci5xdWVyeVNlbGVjdG9yKCIuZm9vdGVyLXJlbWFpbmluZy10aW1lIikudGV4dENvbnRlbnQgPQogICAgICAgICAgcmVtYWluaW5nVGltZVN0cmluZzsKICAgICAgfQoKICAgICAgc2V0SW50ZXJ2YWwodXBkYXRlUmVtYWluaW5nVGltZSwgMTAwMCk7CiAgICAgIHVwZGF0ZVJlbWFpbmluZ1RpbWUoKTsKCiAgICAgIGNvbnN0IGNvZGVDb250ZW50ID0gIlNHV0MiICsgcGFnZURhdGEuaW1hZ2VJZDsKCiAgICAgIGNvbnN0IHdyYXBwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIud3JhcHBlciIpOwoKICAgICAgY29uc3QgcXJjb2RlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICBxcmNvZGVFbGVtZW50LmlkID0gInFyY29kZSI7CgogICAgICBuZXcgUVJDb2RlKHFyY29kZUVsZW1lbnQsIHsKICAgICAgICB0ZXh0OiBjb2RlQ29udGVudCwKICAgICAgICB3aWR0aDogMzIwLAogICAgICAgIGhlaWdodDogMzIwLAogICAgICAgIGNvbG9yRGFyazogIiMwMDAwMDAiLAogICAgICAgIGNvbG9yTGlnaHQ6ICIjZmZmZmZmIiwKICAgICAgICBjb3JyZWN0TGV2ZWw6IFFSQ29kZS5Db3JyZWN0TGV2ZWwuTSwKICAgICAgICB1c2VTVkc6IHRydWUsCiAgICAgIH0pOwogICAgICB3cmFwcGVyLmFwcGVuZENoaWxkKHFyY29kZUVsZW1lbnQpOwogICAgPC9zY3JpcHQ+CiAgPC9ib2R5Pgo8L2h0bWw+Cg==";

const contentHTML = base64Decode(b64ContentHTML);

const pageData = extractPageData();
const pageDataHTML = `<script type="application/json" id="pagedata">${JSON.stringify(
  pageData
)}</script>`;
const replacedPageContent = contentHTML.replace(
  "__PAGE_DATA_PLACEHOLDER__",
  pageDataHTML
);

$done({
  body: replacedPageContent,
});
